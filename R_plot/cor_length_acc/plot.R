library(ggplot2)
library(ggpubr)
library(patchwork)

plot_cor <- function(input_data, color_num){
  df <- read.csv(input_data, sep = "\t", header = T)
  
  p1 <- ggplot(df, aes(x=length_sup, y=estimated_acc_sup)) +
    geom_point(color = color_num, size=0.5) + theme_bw() +
    theme(panel.grid=element_blank())+
    scale_x_continuous(name = "", limits = c(0, 500000), breaks = seq(0, 500000, 100000)) +
    scale_y_continuous(name = "Estimated read acc (sup)", limits = c(0, 100), breaks = seq(0, 100, 25)) +
    stat_cor(method = "pearson", aes(x=length_sup, y=estimated_acc_sup))
  
  p2 <- ggplot(df, aes(x=length_sup, y=observed_acc_sup)) +
    geom_point(color = color_num, size=0.5) + theme_bw() +
    theme(panel.grid=element_blank())+
    scale_x_continuous(name = "", limits = c(0, 500000), breaks = seq(0, 500000, 100000)) +
    scale_y_continuous(name = "Observed read acc (sup)", limits = c(0, 100), breaks = seq(0, 100, 25)) +
    stat_cor(method = "pearson", aes(x=length_sup, y=estimated_acc_sup))
  
  p3 <- ggplot(df, aes(x=length_hac, y=estimated_acc_hac)) +
    geom_point(color = color_num, size=0.5) + theme_bw() +
    theme(panel.grid=element_blank())+
    scale_x_continuous(name = "", limits = c(0, 500000), breaks = seq(0, 500000, 100000)) +
    scale_y_continuous(name = "Estimated read acc (hac)", limits = c(0, 100), breaks = seq(0, 100, 25)) +
    stat_cor(method = "pearson", aes(x=length_sup, y=estimated_acc_sup))
  
  p4 <- ggplot(df, aes(x=length_hac, y=observed_acc_hac)) +
    geom_point(color = color_num, size=0.5) + theme_bw() +
    theme(panel.grid=element_blank())+
    scale_x_continuous(name = "", limits = c(0, 500000), breaks = seq(0, 500000, 100000)) +
    scale_y_continuous(name = "Observed read acc (hac)", limits = c(0, 100), breaks = seq(0, 100, 25)) +
    stat_cor(method = "pearson", aes(x=length_sup, y=estimated_acc_sup))
  
  (p1 | p3) / (p2 | p4)
}

plot_cor("wga_r104_length_and_acc.txt", "#fec44f")
plot_cor("wga_r941_length_and_acc.txt", "#9ecae1")
plot_cor("wgs_r104_length_and_acc.txt", "#fc9272")
plot_cor("wgs_r941_length_and_acc.txt", "#bcbddc")

"""
demo dataset

==> wga_r104_length_and_acc.txt <==
ID	length_sup	estimated_acc_sup	observed_acc_sup	length_hac	estimated_acc_hac	observed_acc_hac
5763b587-2177-43b6-ba8a-bbc92e9ba56f	291.0	97.2961135623274	95.56313993174061	289.0	96.46543340849118	93.83561643835617
f26f3251-8b8c-47e5-aa00-2de62ac1e18f	22996.0	98.3098744688338	98.25636192271442	22940.0	96.88836957768086	97.22744360902256
4e64e04c-f707-4773-89a7-a5f483b30999	7391.0	98.04068786831898	94.37804338202744	7285.0	95.93801459973096	92.43435692033823
a872fa39-b8b6-43ca-9931-8e274c3d3d89	572.0	98.02048728971022	98.62385321100918	570.0	95.23007166459038	96.80365296803653
32c22d4b-7d5d-4baa-838a-adb1f448b8a5	1135.0	97.54977611528153	97.24517906336088	1137.0	87.96705572530976	86.60071942446044
aaa0bba2-f05e-4aa3-b87b-84f8388b4ac6	11275.0	98.75115542469834	97.63815638614996	11268.0	97.72958766489404	96.75873088335996
924a9ae4-66ca-4c0a-91db-da86273b530c	1276.0	98.1047262026052	98.99280575539568	1282.0	96.2557672924046	97.53979739507959
b08e1a5a-46c6-467f-a372-6a6cdee44fca	373.0	92.45147943833098	92.02279202279202	364.0	89.11918942124849	87.17948717948718
99d9f989-9af5-4ba9-ba40-b8e217223506	32659.0	97.93193773286727	97.06237911025146	32735.0	94.50378903952311	94.56600144265448

==> wga_r941_length_and_acc.txt <==
ID	length_sup	estimated_acc_sup	observed_acc_sup	length_hac	estimated_acc_hac	observed_acc_hac
bedf6731-2510-46c4-9283-28c17237654e	5876.0	94.78705134500666	94.20505200594354	5879.0	94.30676540082383	93.35062048527504
ff89f4e5-016b-4202-b624-07e1ec3ca5eb	3173.0	76.0632860301657	76.07095046854083	3062.0	73.55556879448044	71.5450166728418
ae6f91db-bf7d-425c-af75-86b1f2feba13	2273.0	95.05231986209152	96.64429530201342	2276.0	94.62985538035215	96.71886651752423
0326bbab-58c7-43cd-bfe4-25f254bfa118	4114.0	97.45476368438065	97.42997401097314	4111.0	97.1745290110388	97.17334871646958
8fc616e2-e43b-4427-b8c5-c84c9dfb6842	4116.0	97.43391736023536	97.65895184889598	4125.0	97.28283814699475	96.92470837751856
104d143b-ca69-4458-a267-8d6d34c7a9d9	2061.0	94.35714613680216	94.543698696282	2074.0	93.93001627649043	93.80403458213256
a3f4ba0b-711f-4243-88b8-d6de9b7ea63e	402.0	91.48128913760391	94.48818897637796	403.0	90.33836053458695	92.49329758713137
de258e6d-a2fe-474d-b546-4307bc1fe681	3461.0	96.37390825129154	96.28469113697403	3445.0	95.96150161217176	95.26996876394466
b6fb2378-f07e-49d6-a6b8-2909fea93672	1517.0	96.33836556087134	94.63576158940397	1522.0	96.42831395841837	94.75083056478405

==> wgs_r104_length_and_acc.txt <==
ID	length_sup	estimated_acc_sup	observed_acc_sup	observed_acc_sup	length_hac	estimated_acc_hac	observed_acc_hac
64bfb726-c26f-43ff-bad7-f8c914596847	2835.0	87.38366588989437	81.55699721964783	2824.0	81.31181522924729	81.86874304783092
8f5a6d89-18ca-4931-ac76-f098f40030f2	104337.0	98.74478581822338	97.5302438835852	104070.0	97.18094680962938	96.31185447818714
ee4d5931-b3e4-4849-a4d1-7e3ae5ec2e56	6468.0	97.66198828111521	94.26993441491197	6346.0	94.55112234505059	92.49152844658462
5e59c87f-9354-4571-be3c-60ed84cf227a	18907.0	97.85516917372674	97.55226327809333	18808.0	96.53504560588829	96.60390435485733
ada9d738-fdd2-4638-a4cd-e32af9e94d24	28493.0	98.18813641384632	98.29148033482399	28473.0	96.13165502173364	96.03227477977644
1077031e-a56d-4a53-ace6-7f33efa04be1	3084.0	98.9848075859487	95.75440888308296	3084.0	97.19033876169554	94.84231274638633
0afd0051-7053-4c15-90d0-86d9219339f2	18584.0	78.85444916744436	77.26647625092563	16149.0	63.63750918061921	86.72566371681415
59cd2397-0d19-466e-9dd5-1191c8d61f15	1436.0	97.66748334496549	97.56795422031473	1425.0	94.91179755970907	94.07142857142857
863d24e5-cf1b-41f2-b5fd-fe8dd2450cf4	18101.0	88.36324974250059	86.9044478446684	17708.0	81.58930833180061	79.88385476614

==> wgs_r941_length_and_acc.txt <==
ID	length_sup	estimated_acc_sup	observed_acc_sup	length_hac	estimated_acc_hac	observed_acc_hac
458ef2b6-a81f-4393-bf43-fc185654e4e8	18194.0	96.91676618364632	95.32846715328468	18206.0	96.30767210884427	95.01043219076006
958d74a3-8999-4e1b-8156-41819f5c3d95	31675.0	95.55178076175757	94.17618636203642	31650.0	95.20734674860851	93.23418650667007
96644b8d-98da-48d7-af6c-583895a9cba2	33880.0	95.74595359061803	94.66358034345772	33908.0	95.42177138460349	93.75038885086792
035e8d64-eeb1-4447-8f1e-fd167d89b563	22349.0	95.97719841010908	94.26757248790018	22321.0	95.55660210561908	93.56282119440014
a54dc3d2-eb8f-4b8f-90fe-d6700bb9f630	23520.0	91.76399615210667	88.42307524346042	23388.0	91.19963442467989	87.73245614035088
7ff5db38-65fd-4aef-ab8a-a8fe153ca2d8	20695.0	95.91643943764328	93.24753816495597	20647.0	95.72383637662804	92.51170046801872
897f38a9-6e6c-4dac-bc9a-f37b8c0351d7	19973.0	96.46740078100409	95.70011636283039	19979.0	96.26214239581071	95.21087680355161
70ae9e51-e632-440d-b498-b4abcf5e3507	51580.0	96.36661459037693	95.83872458410352	51468.0	95.57448943704394	94.70821425278879
8cc8d1aa-072f-499a-8c31-2e8e86b13cb5	45338.0	95.95505822354703	95.3227208270436	45039.0	95.20724641573392	94.03797726808685
"""
